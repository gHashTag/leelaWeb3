9f58315c0e6fa8bb14decc20773c2b45
var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.ReactNavigationV5Instrumentation = exports.ReactNavigationInstrumentation = exports.BLANK_TRANSACTION_CONTEXT = void 0;
var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));
var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));
var _get2 = _interopRequireDefault(require("@babel/runtime/helpers/get"));
var _inherits2 = _interopRequireDefault(require("@babel/runtime/helpers/inherits"));
var _possibleConstructorReturn2 = _interopRequireDefault(require("@babel/runtime/helpers/possibleConstructorReturn"));
var _getPrototypeOf2 = _interopRequireDefault(require("@babel/runtime/helpers/getPrototypeOf"));
var _utils = require("@sentry/utils");
var _worldwide = require("../utils/worldwide");
var _routingInstrumentation = require("./routingInstrumentation");
var _utils2 = require("./utils");
function _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = (0, _getPrototypeOf2.default)(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = (0, _getPrototypeOf2.default)(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return (0, _possibleConstructorReturn2.default)(this, result); }; }
function _isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }
var defaultOptions = {
  routeChangeTimeoutMs: 1000
};
var ReactNavigationInstrumentation = function (_InternalRoutingInstr) {
  (0, _inherits2.default)(ReactNavigationInstrumentation, _InternalRoutingInstr);
  var _super = _createSuper(ReactNavigationInstrumentation);
  function ReactNavigationInstrumentation() {
    var _this;
    var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
    (0, _classCallCheck2.default)(this, ReactNavigationInstrumentation);
    _this = _super.call(this);
    _this.name = ReactNavigationInstrumentation.instrumentationName;
    _this._navigationContainer = null;
    _this._maxRecentRouteLen = 200;
    _this._initialStateHandled = false;
    _this._recentRouteKeys = [];
    _this._pushRecentRouteKey = function (key) {
      _this._recentRouteKeys.push(key);
      if (_this._recentRouteKeys.length > _this._maxRecentRouteLen) {
        _this._recentRouteKeys = _this._recentRouteKeys.slice(_this._recentRouteKeys.length - _this._maxRecentRouteLen);
      }
    };
    _this._options = Object.assign(Object.assign({}, defaultOptions), options);
    return _this;
  }
  (0, _createClass2.default)(ReactNavigationInstrumentation, [{
    key: "registerRoutingInstrumentation",
    value: function registerRoutingInstrumentation(listener, beforeNavigate, onConfirmRoute) {
      (0, _get2.default)((0, _getPrototypeOf2.default)(ReactNavigationInstrumentation.prototype), "registerRoutingInstrumentation", this).call(this, listener, beforeNavigate, onConfirmRoute);
      if (!this._initialStateHandled) {
        this._onDispatch();
        if (this._navigationContainer) {
          this._onStateChange();
          this._initialStateHandled = true;
        }
      }
    }
  }, {
    key: "registerNavigationContainer",
    value: function registerNavigationContainer(navigationContainerRef) {
      if (!_worldwide.RN_GLOBAL_OBJ.__sentry_rn_v5_registered) {
        if ('current' in navigationContainerRef) {
          this._navigationContainer = navigationContainerRef.current;
        } else {
          this._navigationContainer = navigationContainerRef;
        }
        if (this._navigationContainer) {
          this._navigationContainer.addListener('__unsafe_action__', this._onDispatch.bind(this));
          this._navigationContainer.addListener('state', this._onStateChange.bind(this));
          if (!this._initialStateHandled) {
            if (this._latestTransaction) {
              this._onStateChange();
              this._initialStateHandled = true;
            } else {
              _utils.logger.log('[ReactNavigationInstrumentation] Navigation container registered, but integration has not been setup yet.');
            }
          }
          _worldwide.RN_GLOBAL_OBJ.__sentry_rn_v5_registered = true;
        } else {
          _utils.logger.warn('[ReactNavigationInstrumentation] Received invalid navigation container ref!');
        }
      } else {
        _utils.logger.log('[ReactNavigationInstrumentation] Instrumentation already exists, but register has been called again, doing nothing.');
      }
    }
  }, {
    key: "_onDispatch",
    value: function _onDispatch() {
      if (this._latestTransaction) {
        _utils.logger.log('[ReactNavigationInstrumentation] A transaction was detected that turned out to be a noop, discarding.');
        this._discardLatestTransaction();
        this._clearStateChangeTimeout();
      }
      this._latestTransaction = this.onRouteWillChange((0, _utils2.getBlankTransactionContext)(ReactNavigationInstrumentation.instrumentationName));
      this._stateChangeTimeout = setTimeout(this._discardLatestTransaction.bind(this), this._options.routeChangeTimeoutMs);
    }
  }, {
    key: "_onStateChange",
    value: function _onStateChange() {
      var _a, _b, _c;
      var previousRoute = this._latestRoute;
      if (!this._navigationContainer) {
        _utils.logger.warn('[ReactNavigationInstrumentation] Missing navigation container ref. Route transactions will not be sent.');
        return;
      }
      var route = this._navigationContainer.getCurrentRoute();
      if (route) {
        if (this._latestTransaction) {
          if (!previousRoute || previousRoute.key !== route.key) {
            var originalContext = this._latestTransaction.toContext();
            var routeHasBeenSeen = this._recentRouteKeys.includes(route.key);
            var data = Object.assign(Object.assign({}, originalContext.data), {
              route: {
                name: route.name,
                key: route.key,
                params: (_a = route.params) !== null && _a !== void 0 ? _a : {},
                hasBeenSeen: routeHasBeenSeen
              },
              previousRoute: previousRoute ? {
                name: previousRoute.name,
                key: previousRoute.key,
                params: (_b = previousRoute.params) !== null && _b !== void 0 ? _b : {}
              } : null
            });
            var updatedContext = Object.assign(Object.assign({}, originalContext), {
              name: route.name,
              tags: Object.assign(Object.assign({}, originalContext.tags), {
                'routing.route.name': route.name
              }),
              data: data
            });
            var finalContext = this._prepareFinalContext(updatedContext);
            this._latestTransaction.updateWithContext(finalContext);
            var isCustomName = updatedContext.name !== finalContext.name;
            this._latestTransaction.setName(finalContext.name, isCustomName ? _utils2.customTransactionSource : _utils2.defaultTransactionSource);
            (_c = this._onConfirmRoute) === null || _c === void 0 ? void 0 : _c.call(this, finalContext);
          }
          this._pushRecentRouteKey(route.key);
          this._latestRoute = route;
          this._latestTransaction = undefined;
        }
      }
    }
  }, {
    key: "_prepareFinalContext",
    value: function _prepareFinalContext(updatedContext) {
      var _a;
      var finalContext = (_a = this._beforeNavigate) === null || _a === void 0 ? void 0 : _a.call(this, Object.assign({}, updatedContext));
      if (!finalContext) {
        _utils.logger.error(`[ReactNavigationInstrumentation] beforeNavigate returned ${finalContext}, return context.sampled = false to not send transaction.`);
        finalContext = Object.assign(Object.assign({}, updatedContext), {
          sampled: false
        });
      }
      if (finalContext.sampled === false) {
        _utils.logger.log(`[ReactNavigationInstrumentation] Will not send transaction "${finalContext.name}" due to beforeNavigate.`);
      } else {
        this._clearStateChangeTimeout();
      }
      return finalContext;
    }
  }, {
    key: "_discardLatestTransaction",
    value: function _discardLatestTransaction() {
      if (this._latestTransaction) {
        this._latestTransaction.sampled = false;
        this._latestTransaction.finish();
        this._latestTransaction = undefined;
      }
    }
  }, {
    key: "_clearStateChangeTimeout",
    value: function _clearStateChangeTimeout() {
      if (typeof this._stateChangeTimeout !== 'undefined') {
        clearTimeout(this._stateChangeTimeout);
        this._stateChangeTimeout = undefined;
      }
    }
  }]);
  return ReactNavigationInstrumentation;
}(_routingInstrumentation.InternalRoutingInstrumentation);
exports.ReactNavigationInstrumentation = ReactNavigationInstrumentation;
ReactNavigationInstrumentation.instrumentationName = 'react-navigation-v5';
var ReactNavigationV5Instrumentation = ReactNavigationInstrumentation;
exports.ReactNavigationV5Instrumentation = ReactNavigationV5Instrumentation;
var BLANK_TRANSACTION_CONTEXT = {
  name: 'Route Change',
  op: 'navigation',
  tags: {
    'routing.instrumentation': ReactNavigationInstrumentation.instrumentationName
  },
  data: {}
};
exports.BLANK_TRANSACTION_CONTEXT = BLANK_TRANSACTION_CONTEXT;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfdXRpbHMiLCJyZXF1aXJlIiwiX3dvcmxkd2lkZSIsIl9yb3V0aW5nSW5zdHJ1bWVudGF0aW9uIiwiX3V0aWxzMiIsIl9jcmVhdGVTdXBlciIsIkRlcml2ZWQiLCJoYXNOYXRpdmVSZWZsZWN0Q29uc3RydWN0IiwiX2lzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCIsIl9jcmVhdGVTdXBlckludGVybmFsIiwiU3VwZXIiLCJfZ2V0UHJvdG90eXBlT2YyIiwiZGVmYXVsdCIsInJlc3VsdCIsIk5ld1RhcmdldCIsImNvbnN0cnVjdG9yIiwiUmVmbGVjdCIsImNvbnN0cnVjdCIsImFyZ3VtZW50cyIsImFwcGx5IiwiX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4yIiwic2hhbSIsIlByb3h5IiwiQm9vbGVhbiIsInByb3RvdHlwZSIsInZhbHVlT2YiLCJjYWxsIiwiZSIsImRlZmF1bHRPcHRpb25zIiwicm91dGVDaGFuZ2VUaW1lb3V0TXMiLCJSZWFjdE5hdmlnYXRpb25JbnN0cnVtZW50YXRpb24iLCJfSW50ZXJuYWxSb3V0aW5nSW5zdHIiLCJfaW5oZXJpdHMyIiwiX3N1cGVyIiwiX3RoaXMiLCJvcHRpb25zIiwibGVuZ3RoIiwidW5kZWZpbmVkIiwiX2NsYXNzQ2FsbENoZWNrMiIsIm5hbWUiLCJpbnN0cnVtZW50YXRpb25OYW1lIiwiX25hdmlnYXRpb25Db250YWluZXIiLCJfbWF4UmVjZW50Um91dGVMZW4iLCJfaW5pdGlhbFN0YXRlSGFuZGxlZCIsIl9yZWNlbnRSb3V0ZUtleXMiLCJfcHVzaFJlY2VudFJvdXRlS2V5Iiwia2V5IiwicHVzaCIsInNsaWNlIiwiX29wdGlvbnMiLCJPYmplY3QiLCJhc3NpZ24iLCJfY3JlYXRlQ2xhc3MyIiwidmFsdWUiLCJyZWdpc3RlclJvdXRpbmdJbnN0cnVtZW50YXRpb24iLCJsaXN0ZW5lciIsImJlZm9yZU5hdmlnYXRlIiwib25Db25maXJtUm91dGUiLCJfZ2V0MiIsIl9vbkRpc3BhdGNoIiwiX29uU3RhdGVDaGFuZ2UiLCJyZWdpc3Rlck5hdmlnYXRpb25Db250YWluZXIiLCJuYXZpZ2F0aW9uQ29udGFpbmVyUmVmIiwiUk5fR0xPQkFMX09CSiIsIl9fc2VudHJ5X3JuX3Y1X3JlZ2lzdGVyZWQiLCJjdXJyZW50IiwiYWRkTGlzdGVuZXIiLCJiaW5kIiwiX2xhdGVzdFRyYW5zYWN0aW9uIiwibG9nZ2VyIiwibG9nIiwid2FybiIsIl9kaXNjYXJkTGF0ZXN0VHJhbnNhY3Rpb24iLCJfY2xlYXJTdGF0ZUNoYW5nZVRpbWVvdXQiLCJvblJvdXRlV2lsbENoYW5nZSIsImdldEJsYW5rVHJhbnNhY3Rpb25Db250ZXh0IiwiX3N0YXRlQ2hhbmdlVGltZW91dCIsInNldFRpbWVvdXQiLCJwcmV2aW91c1JvdXRlIiwiX2xhdGVzdFJvdXRlIiwicm91dGUiLCJnZXRDdXJyZW50Um91dGUiLCJvcmlnaW5hbENvbnRleHQiLCJ0b0NvbnRleHQiLCJyb3V0ZUhhc0JlZW5TZWVuIiwiaW5jbHVkZXMiLCJkYXRhIiwicGFyYW1zIiwiX2EiLCJoYXNCZWVuU2VlbiIsIl9iIiwidXBkYXRlZENvbnRleHQiLCJ0YWdzIiwiZmluYWxDb250ZXh0IiwiX3ByZXBhcmVGaW5hbENvbnRleHQiLCJ1cGRhdGVXaXRoQ29udGV4dCIsImlzQ3VzdG9tTmFtZSIsInNldE5hbWUiLCJjdXN0b21UcmFuc2FjdGlvblNvdXJjZSIsImRlZmF1bHRUcmFuc2FjdGlvblNvdXJjZSIsIl9jIiwiX29uQ29uZmlybVJvdXRlIiwiX2JlZm9yZU5hdmlnYXRlIiwiZXJyb3IiLCJzYW1wbGVkIiwiZmluaXNoIiwiY2xlYXJUaW1lb3V0IiwiSW50ZXJuYWxSb3V0aW5nSW5zdHJ1bWVudGF0aW9uIiwiZXhwb3J0cyIsIlJlYWN0TmF2aWdhdGlvblY1SW5zdHJ1bWVudGF0aW9uIiwiQkxBTktfVFJBTlNBQ1RJT05fQ09OVEVYVCIsIm9wIl0sInNvdXJjZXMiOlsiLi4vLi4vLi4vc3JjL2pzL3RyYWNpbmcvcmVhY3RuYXZpZ2F0aW9uLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qIGVzbGludC1kaXNhYmxlIG1heC1saW5lcyAqL1xuaW1wb3J0IHR5cGUgeyBUcmFuc2FjdGlvbiBhcyBUcmFuc2FjdGlvblR5cGUsIFRyYW5zYWN0aW9uQ29udGV4dCB9IGZyb20gJ0BzZW50cnkvdHlwZXMnO1xuaW1wb3J0IHsgbG9nZ2VyIH0gZnJvbSAnQHNlbnRyeS91dGlscyc7XG5cbmltcG9ydCB7IFJOX0dMT0JBTF9PQkogfSBmcm9tICcuLi91dGlscy93b3JsZHdpZGUnO1xuaW1wb3J0IHR5cGUgeyBPbkNvbmZpcm1Sb3V0ZSwgVHJhbnNhY3Rpb25DcmVhdG9yIH0gZnJvbSAnLi9yb3V0aW5nSW5zdHJ1bWVudGF0aW9uJztcbmltcG9ydCB7IEludGVybmFsUm91dGluZ0luc3RydW1lbnRhdGlvbiB9IGZyb20gJy4vcm91dGluZ0luc3RydW1lbnRhdGlvbic7XG5pbXBvcnQgdHlwZSB7IEJlZm9yZU5hdmlnYXRlLCBSZWFjdE5hdmlnYXRpb25UcmFuc2FjdGlvbkNvbnRleHQsIFJvdXRlQ2hhbmdlQ29udGV4dERhdGEgfSBmcm9tICcuL3R5cGVzJztcbmltcG9ydCB7IGN1c3RvbVRyYW5zYWN0aW9uU291cmNlLCBkZWZhdWx0VHJhbnNhY3Rpb25Tb3VyY2UsIGdldEJsYW5rVHJhbnNhY3Rpb25Db250ZXh0IH0gZnJvbSAnLi91dGlscyc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgTmF2aWdhdGlvblJvdXRlIHtcbiAgbmFtZTogc3RyaW5nO1xuICBrZXk6IHN0cmluZztcbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgcGFyYW1zPzogUmVjb3JkPHN0cmluZywgYW55Pjtcbn1cblxuaW50ZXJmYWNlIE5hdmlnYXRpb25Db250YWluZXIge1xuICBhZGRMaXN0ZW5lcjogKHR5cGU6IHN0cmluZywgbGlzdGVuZXI6ICgpID0+IHZvaWQpID0+IHZvaWQ7XG4gIGdldEN1cnJlbnRSb3V0ZTogKCkgPT4gTmF2aWdhdGlvblJvdXRlO1xufVxuXG5pbnRlcmZhY2UgUmVhY3ROYXZpZ2F0aW9uT3B0aW9ucyB7XG4gIC8qKlxuICAgKiBIb3cgbG9uZyB0aGUgaW5zdHJ1bWVudGF0aW9uIHdpbGwgd2FpdCBmb3IgdGhlIHJvdXRlIHRvIG1vdW50IGFmdGVyIGEgY2hhbmdlIGhhcyBiZWVuIGluaXRpYXRlZCxcbiAgICogYmVmb3JlIHRoZSB0cmFuc2FjdGlvbiBpcyBkaXNjYXJkZWQuXG4gICAqIFRpbWUgaXMgaW4gbXMuXG4gICAqXG4gICAqIERlZmF1bHQ6IDEwMDBcbiAgICovXG4gIHJvdXRlQ2hhbmdlVGltZW91dE1zOiBudW1iZXI7XG59XG5cbmNvbnN0IGRlZmF1bHRPcHRpb25zOiBSZWFjdE5hdmlnYXRpb25PcHRpb25zID0ge1xuICByb3V0ZUNoYW5nZVRpbWVvdXRNczogMTAwMCxcbn07XG5cbi8qKlxuICogSW5zdHJ1bWVudGF0aW9uIGZvciBSZWFjdC1OYXZpZ2F0aW9uIFY1IGFuZCBhYm92ZS4gU2VlIGRvY3Mgb3Igc2FtcGxlIGFwcCBmb3IgdXNhZ2UuXG4gKlxuICogSG93IHRoaXMgd29ya3M6XG4gKiAtIGBfb25EaXNwYXRjaGAgaXMgY2FsbGVkIGV2ZXJ5IHRpbWUgYSBkaXNwYXRjaCBoYXBwZW5zIGFuZCBzZXRzIGFuIElkbGVUcmFuc2FjdGlvbiBvbiB0aGUgc2NvcGUgd2l0aG91dCBhbnkgcm91dGUgY29udGV4dC5cbiAqIC0gYF9vblN0YXRlQ2hhbmdlYCBpcyB0aGVuIGNhbGxlZCBBRlRFUiB0aGUgc3RhdGUgY2hhbmdlIGhhcHBlbnMgZHVlIHRvIGEgZGlzcGF0Y2ggYW5kIHNldHMgdGhlIHJvdXRlIGNvbnRleHQgb250byB0aGUgYWN0aXZlIHRyYW5zYWN0aW9uLlxuICogLSBJZiBgX29uU3RhdGVDaGFuZ2VgIGlzbid0IGNhbGxlZCB3aXRoaW4gYFNUQVRFX0NIQU5HRV9USU1FT1VUX0RVUkFUSU9OYCBvZiB0aGUgZGlzcGF0Y2gsIHRoZW4gdGhlIHRyYW5zYWN0aW9uIGlzIG5vdCBzYW1wbGVkIGFuZCBmaW5pc2hlZC5cbiAqL1xuZXhwb3J0IGNsYXNzIFJlYWN0TmF2aWdhdGlvbkluc3RydW1lbnRhdGlvbiBleHRlbmRzIEludGVybmFsUm91dGluZ0luc3RydW1lbnRhdGlvbiB7XG4gIHB1YmxpYyBzdGF0aWMgaW5zdHJ1bWVudGF0aW9uTmFtZTogc3RyaW5nID0gJ3JlYWN0LW5hdmlnYXRpb24tdjUnO1xuXG4gIHB1YmxpYyByZWFkb25seSBuYW1lOiBzdHJpbmcgPSBSZWFjdE5hdmlnYXRpb25JbnN0cnVtZW50YXRpb24uaW5zdHJ1bWVudGF0aW9uTmFtZTtcblxuICBwcml2YXRlIF9uYXZpZ2F0aW9uQ29udGFpbmVyOiBOYXZpZ2F0aW9uQ29udGFpbmVyIHwgbnVsbCA9IG51bGw7XG5cbiAgcHJpdmF0ZSByZWFkb25seSBfbWF4UmVjZW50Um91dGVMZW46IG51bWJlciA9IDIwMDtcblxuICBwcml2YXRlIF9sYXRlc3RSb3V0ZT86IE5hdmlnYXRpb25Sb3V0ZTtcbiAgcHJpdmF0ZSBfbGF0ZXN0VHJhbnNhY3Rpb24/OiBUcmFuc2FjdGlvblR5cGU7XG4gIHByaXZhdGUgX2luaXRpYWxTdGF0ZUhhbmRsZWQ6IGJvb2xlYW4gPSBmYWxzZTtcbiAgcHJpdmF0ZSBfc3RhdGVDaGFuZ2VUaW1lb3V0PzogbnVtYmVyIHwgdW5kZWZpbmVkO1xuICBwcml2YXRlIF9yZWNlbnRSb3V0ZUtleXM6IHN0cmluZ1tdID0gW107XG5cbiAgcHJpdmF0ZSBfb3B0aW9uczogUmVhY3ROYXZpZ2F0aW9uT3B0aW9ucztcblxuICBwdWJsaWMgY29uc3RydWN0b3Iob3B0aW9uczogUGFydGlhbDxSZWFjdE5hdmlnYXRpb25PcHRpb25zPiA9IHt9KSB7XG4gICAgc3VwZXIoKTtcblxuICAgIHRoaXMuX29wdGlvbnMgPSB7XG4gICAgICAuLi5kZWZhdWx0T3B0aW9ucyxcbiAgICAgIC4uLm9wdGlvbnMsXG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBFeHRlbmRzIGJ5IGNhbGxpbmcgX2hhbmRsZUluaXRpYWxTdGF0ZSBhdCB0aGUgZW5kLlxuICAgKi9cbiAgcHVibGljIHJlZ2lzdGVyUm91dGluZ0luc3RydW1lbnRhdGlvbihcbiAgICBsaXN0ZW5lcjogVHJhbnNhY3Rpb25DcmVhdG9yLFxuICAgIGJlZm9yZU5hdmlnYXRlOiBCZWZvcmVOYXZpZ2F0ZSxcbiAgICBvbkNvbmZpcm1Sb3V0ZTogT25Db25maXJtUm91dGUsXG4gICk6IHZvaWQge1xuICAgIHN1cGVyLnJlZ2lzdGVyUm91dGluZ0luc3RydW1lbnRhdGlvbihsaXN0ZW5lciwgYmVmb3JlTmF2aWdhdGUsIG9uQ29uZmlybVJvdXRlKTtcblxuICAgIC8vIFdlIGNyZWF0ZSBhbiBpbml0aWFsIHN0YXRlIGhlcmUgdG8gZW5zdXJlIGEgdHJhbnNhY3Rpb24gZ2V0cyBjcmVhdGVkIGJlZm9yZSB0aGUgZmlyc3Qgcm91dGUgbW91bnRzLlxuICAgIGlmICghdGhpcy5faW5pdGlhbFN0YXRlSGFuZGxlZCkge1xuICAgICAgdGhpcy5fb25EaXNwYXRjaCgpO1xuICAgICAgaWYgKHRoaXMuX25hdmlnYXRpb25Db250YWluZXIpIHtcbiAgICAgICAgLy8gTmF2aWdhdGlvbiBjb250YWluZXIgYWxyZWFkeSByZWdpc3RlcmVkLCBqdXN0IHBvcHVsYXRlIHdpdGggcm91dGUgc3RhdGVcbiAgICAgICAgdGhpcy5fb25TdGF0ZUNoYW5nZSgpO1xuXG4gICAgICAgIHRoaXMuX2luaXRpYWxTdGF0ZUhhbmRsZWQgPSB0cnVlO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBQYXNzIHRoZSByZWYgdG8gdGhlIG5hdmlnYXRpb24gY29udGFpbmVyIHRvIHJlZ2lzdGVyIGl0IHRvIHRoZSBpbnN0cnVtZW50YXRpb25cbiAgICogQHBhcmFtIG5hdmlnYXRpb25Db250YWluZXJSZWYgUmVmIHRvIGEgYE5hdmlnYXRpb25Db250YWluZXJgXG4gICAqL1xuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueSwgQHR5cGVzY3JpcHQtZXNsaW50L2V4cGxpY2l0LW1vZHVsZS1ib3VuZGFyeS10eXBlc1xuICBwdWJsaWMgcmVnaXN0ZXJOYXZpZ2F0aW9uQ29udGFpbmVyKG5hdmlnYXRpb25Db250YWluZXJSZWY6IGFueSk6IHZvaWQge1xuICAgIC8qIFdlIHByZXZlbnQgZHVwbGljYXRlIHJvdXRpbmcgaW5zdHJ1bWVudGF0aW9uIHRvIGJlIGluaXRpYWxpemVkIG9uIGZhc3QgcmVmcmVzaGVzXG5cbiAgICAgIEV4cGxhbmF0aW9uOiBJZiB0aGUgdXNlciB0cmlnZ2VycyBhIGZhc3QgcmVmcmVzaCBvbiB0aGUgZmlsZSB0aGF0IHRoZSBpbnN0cnVtZW50YXRpb24gaXNcbiAgICAgIGluaXRpYWxpemVkIGluLCBpdCB3aWxsIGluaXRpYWxpemUgYSBuZXcgaW5zdGFuY2UgYW5kIHdpbGwgY2F1c2UgdW5kZWZpbmVkIGJlaGF2aW9yLlxuICAgICAqL1xuICAgIGlmICghUk5fR0xPQkFMX09CSi5fX3NlbnRyeV9ybl92NV9yZWdpc3RlcmVkKSB7XG4gICAgICBpZiAoJ2N1cnJlbnQnIGluIG5hdmlnYXRpb25Db250YWluZXJSZWYpIHtcbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby11bnNhZmUtbWVtYmVyLWFjY2Vzc1xuICAgICAgICB0aGlzLl9uYXZpZ2F0aW9uQ29udGFpbmVyID0gbmF2aWdhdGlvbkNvbnRhaW5lclJlZi5jdXJyZW50O1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5fbmF2aWdhdGlvbkNvbnRhaW5lciA9IG5hdmlnYXRpb25Db250YWluZXJSZWY7XG4gICAgICB9XG5cbiAgICAgIGlmICh0aGlzLl9uYXZpZ2F0aW9uQ29udGFpbmVyKSB7XG4gICAgICAgIHRoaXMuX25hdmlnYXRpb25Db250YWluZXIuYWRkTGlzdGVuZXIoXG4gICAgICAgICAgJ19fdW5zYWZlX2FjdGlvbl9fJywgLy8gVGhpcyBhY3Rpb24gaXMgZW1pdHRlZCBvbiBldmVyeSBkaXNwYXRjaFxuICAgICAgICAgIHRoaXMuX29uRGlzcGF0Y2guYmluZCh0aGlzKSxcbiAgICAgICAgKTtcbiAgICAgICAgdGhpcy5fbmF2aWdhdGlvbkNvbnRhaW5lci5hZGRMaXN0ZW5lcihcbiAgICAgICAgICAnc3RhdGUnLCAvLyBUaGlzIGFjdGlvbiBpcyBlbWl0dGVkIG9uIGV2ZXJ5IHN0YXRlIGNoYW5nZVxuICAgICAgICAgIHRoaXMuX29uU3RhdGVDaGFuZ2UuYmluZCh0aGlzKSxcbiAgICAgICAgKTtcblxuICAgICAgICBpZiAoIXRoaXMuX2luaXRpYWxTdGF0ZUhhbmRsZWQpIHtcbiAgICAgICAgICBpZiAodGhpcy5fbGF0ZXN0VHJhbnNhY3Rpb24pIHtcbiAgICAgICAgICAgIC8vIElmIHJlZ2lzdGVyUm91dGluZ0luc3RydW1lbnRhdGlvbiB3YXMgY2FsbGVkIGZpcnN0IF9vbkRpc3BhdGNoIGhhcyBhbHJlYWR5IGJlZW4gY2FsbGVkXG4gICAgICAgICAgICB0aGlzLl9vblN0YXRlQ2hhbmdlKCk7XG5cbiAgICAgICAgICAgIHRoaXMuX2luaXRpYWxTdGF0ZUhhbmRsZWQgPSB0cnVlO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBsb2dnZXIubG9nKFxuICAgICAgICAgICAgICAnW1JlYWN0TmF2aWdhdGlvbkluc3RydW1lbnRhdGlvbl0gTmF2aWdhdGlvbiBjb250YWluZXIgcmVnaXN0ZXJlZCwgYnV0IGludGVncmF0aW9uIGhhcyBub3QgYmVlbiBzZXR1cCB5ZXQuJyxcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgUk5fR0xPQkFMX09CSi5fX3NlbnRyeV9ybl92NV9yZWdpc3RlcmVkID0gdHJ1ZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGxvZ2dlci53YXJuKCdbUmVhY3ROYXZpZ2F0aW9uSW5zdHJ1bWVudGF0aW9uXSBSZWNlaXZlZCBpbnZhbGlkIG5hdmlnYXRpb24gY29udGFpbmVyIHJlZiEnKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgbG9nZ2VyLmxvZyhcbiAgICAgICAgJ1tSZWFjdE5hdmlnYXRpb25JbnN0cnVtZW50YXRpb25dIEluc3RydW1lbnRhdGlvbiBhbHJlYWR5IGV4aXN0cywgYnV0IHJlZ2lzdGVyIGhhcyBiZWVuIGNhbGxlZCBhZ2FpbiwgZG9pbmcgbm90aGluZy4nLFxuICAgICAgKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogVG8gYmUgY2FsbGVkIG9uIGV2ZXJ5IFJlYWN0LU5hdmlnYXRpb24gYWN0aW9uIGRpc3BhdGNoLlxuICAgKiBJdCBkb2VzIG5vdCBuYW1lIHRoZSB0cmFuc2FjdGlvbiBvciBwb3B1bGF0ZSBpdCB3aXRoIHJvdXRlIGluZm9ybWF0aW9uLiBJbnN0ZWFkLCBpdCB3YWl0cyBmb3IgdGhlIHN0YXRlIHRvIGZ1bGx5IGNoYW5nZVxuICAgKiBhbmQgZ2V0cyB0aGUgcm91dGUgaW5mb3JtYXRpb24gZnJvbSB0aGVyZSwgQHNlZSBfb25TdGF0ZUNoYW5nZVxuICAgKi9cbiAgcHJpdmF0ZSBfb25EaXNwYXRjaCgpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5fbGF0ZXN0VHJhbnNhY3Rpb24pIHtcbiAgICAgIGxvZ2dlci5sb2coXG4gICAgICAgICdbUmVhY3ROYXZpZ2F0aW9uSW5zdHJ1bWVudGF0aW9uXSBBIHRyYW5zYWN0aW9uIHdhcyBkZXRlY3RlZCB0aGF0IHR1cm5lZCBvdXQgdG8gYmUgYSBub29wLCBkaXNjYXJkaW5nLicsXG4gICAgICApO1xuICAgICAgdGhpcy5fZGlzY2FyZExhdGVzdFRyYW5zYWN0aW9uKCk7XG4gICAgICB0aGlzLl9jbGVhclN0YXRlQ2hhbmdlVGltZW91dCgpO1xuICAgIH1cblxuICAgIHRoaXMuX2xhdGVzdFRyYW5zYWN0aW9uID0gdGhpcy5vblJvdXRlV2lsbENoYW5nZShcbiAgICAgIGdldEJsYW5rVHJhbnNhY3Rpb25Db250ZXh0KFJlYWN0TmF2aWdhdGlvbkluc3RydW1lbnRhdGlvbi5pbnN0cnVtZW50YXRpb25OYW1lKSxcbiAgICApO1xuXG4gICAgdGhpcy5fc3RhdGVDaGFuZ2VUaW1lb3V0ID0gc2V0VGltZW91dChcbiAgICAgIHRoaXMuX2Rpc2NhcmRMYXRlc3RUcmFuc2FjdGlvbi5iaW5kKHRoaXMpLFxuICAgICAgdGhpcy5fb3B0aW9ucy5yb3V0ZUNoYW5nZVRpbWVvdXRNcyxcbiAgICApO1xuICB9XG5cbiAgLyoqXG4gICAqIFRvIGJlIGNhbGxlZCBBRlRFUiB0aGUgc3RhdGUgaGFzIGJlZW4gY2hhbmdlZCB0byBwb3B1bGF0ZSB0aGUgdHJhbnNhY3Rpb24gd2l0aCB0aGUgY3VycmVudCByb3V0ZS5cbiAgICovXG4gIHByaXZhdGUgX29uU3RhdGVDaGFuZ2UoKTogdm9pZCB7XG4gICAgLy8gVXNlIHRoZSBnZXRDdXJyZW50Um91dGUgbWV0aG9kIHRvIGJlIGFjY3VyYXRlLlxuICAgIGNvbnN0IHByZXZpb3VzUm91dGUgPSB0aGlzLl9sYXRlc3RSb3V0ZTtcblxuICAgIGlmICghdGhpcy5fbmF2aWdhdGlvbkNvbnRhaW5lcikge1xuICAgICAgbG9nZ2VyLndhcm4oXG4gICAgICAgICdbUmVhY3ROYXZpZ2F0aW9uSW5zdHJ1bWVudGF0aW9uXSBNaXNzaW5nIG5hdmlnYXRpb24gY29udGFpbmVyIHJlZi4gUm91dGUgdHJhbnNhY3Rpb25zIHdpbGwgbm90IGJlIHNlbnQuJyxcbiAgICAgICk7XG5cbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjb25zdCByb3V0ZSA9IHRoaXMuX25hdmlnYXRpb25Db250YWluZXIuZ2V0Q3VycmVudFJvdXRlKCk7XG5cbiAgICBpZiAocm91dGUpIHtcbiAgICAgIGlmICh0aGlzLl9sYXRlc3RUcmFuc2FjdGlvbikge1xuICAgICAgICBpZiAoIXByZXZpb3VzUm91dGUgfHwgcHJldmlvdXNSb3V0ZS5rZXkgIT09IHJvdXRlLmtleSkge1xuICAgICAgICAgIGNvbnN0IG9yaWdpbmFsQ29udGV4dCA9IHRoaXMuX2xhdGVzdFRyYW5zYWN0aW9uLnRvQ29udGV4dCgpIGFzIHR5cGVvZiBCTEFOS19UUkFOU0FDVElPTl9DT05URVhUO1xuICAgICAgICAgIGNvbnN0IHJvdXRlSGFzQmVlblNlZW4gPSB0aGlzLl9yZWNlbnRSb3V0ZUtleXMuaW5jbHVkZXMocm91dGUua2V5KTtcblxuICAgICAgICAgIGNvbnN0IGRhdGE6IFJvdXRlQ2hhbmdlQ29udGV4dERhdGEgPSB7XG4gICAgICAgICAgICAuLi5vcmlnaW5hbENvbnRleHQuZGF0YSxcbiAgICAgICAgICAgIHJvdXRlOiB7XG4gICAgICAgICAgICAgIG5hbWU6IHJvdXRlLm5hbWUsXG4gICAgICAgICAgICAgIGtleTogcm91dGUua2V5LFxuICAgICAgICAgICAgICBwYXJhbXM6IHJvdXRlLnBhcmFtcyA/PyB7fSxcbiAgICAgICAgICAgICAgaGFzQmVlblNlZW46IHJvdXRlSGFzQmVlblNlZW4sXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcHJldmlvdXNSb3V0ZTogcHJldmlvdXNSb3V0ZVxuICAgICAgICAgICAgICA/IHtcbiAgICAgICAgICAgICAgICAgIG5hbWU6IHByZXZpb3VzUm91dGUubmFtZSxcbiAgICAgICAgICAgICAgICAgIGtleTogcHJldmlvdXNSb3V0ZS5rZXksXG4gICAgICAgICAgICAgICAgICBwYXJhbXM6IHByZXZpb3VzUm91dGUucGFyYW1zID8/IHt9LFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgOiBudWxsLFxuICAgICAgICAgIH07XG5cbiAgICAgICAgICBjb25zdCB1cGRhdGVkQ29udGV4dDogUmVhY3ROYXZpZ2F0aW9uVHJhbnNhY3Rpb25Db250ZXh0ID0ge1xuICAgICAgICAgICAgLi4ub3JpZ2luYWxDb250ZXh0LFxuICAgICAgICAgICAgbmFtZTogcm91dGUubmFtZSxcbiAgICAgICAgICAgIHRhZ3M6IHtcbiAgICAgICAgICAgICAgLi4ub3JpZ2luYWxDb250ZXh0LnRhZ3MsXG4gICAgICAgICAgICAgICdyb3V0aW5nLnJvdXRlLm5hbWUnOiByb3V0ZS5uYW1lLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGRhdGEsXG4gICAgICAgICAgfTtcblxuICAgICAgICAgIGNvbnN0IGZpbmFsQ29udGV4dCA9IHRoaXMuX3ByZXBhcmVGaW5hbENvbnRleHQodXBkYXRlZENvbnRleHQpO1xuICAgICAgICAgIHRoaXMuX2xhdGVzdFRyYW5zYWN0aW9uLnVwZGF0ZVdpdGhDb250ZXh0KGZpbmFsQ29udGV4dCk7XG5cbiAgICAgICAgICBjb25zdCBpc0N1c3RvbU5hbWUgPSB1cGRhdGVkQ29udGV4dC5uYW1lICE9PSBmaW5hbENvbnRleHQubmFtZTtcbiAgICAgICAgICB0aGlzLl9sYXRlc3RUcmFuc2FjdGlvbi5zZXROYW1lKFxuICAgICAgICAgICAgZmluYWxDb250ZXh0Lm5hbWUsXG4gICAgICAgICAgICBpc0N1c3RvbU5hbWUgPyBjdXN0b21UcmFuc2FjdGlvblNvdXJjZSA6IGRlZmF1bHRUcmFuc2FjdGlvblNvdXJjZSxcbiAgICAgICAgICApO1xuXG4gICAgICAgICAgdGhpcy5fb25Db25maXJtUm91dGU/LihmaW5hbENvbnRleHQpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5fcHVzaFJlY2VudFJvdXRlS2V5KHJvdXRlLmtleSk7XG4gICAgICAgIHRoaXMuX2xhdGVzdFJvdXRlID0gcm91dGU7XG5cbiAgICAgICAgLy8gQ2xlYXIgdGhlIGxhdGVzdCB0cmFuc2FjdGlvbiBhcyBpdCBoYXMgYmVlbiBoYW5kbGVkLlxuICAgICAgICB0aGlzLl9sYXRlc3RUcmFuc2FjdGlvbiA9IHVuZGVmaW5lZDtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvKiogQ3JlYXRlcyBmaW5hbCB0cmFuc2FjdGlvbiBjb250ZXh0IGJlZm9yZSBjb25maXJtYXRpb24gKi9cbiAgcHJpdmF0ZSBfcHJlcGFyZUZpbmFsQ29udGV4dCh1cGRhdGVkQ29udGV4dDogVHJhbnNhY3Rpb25Db250ZXh0KTogVHJhbnNhY3Rpb25Db250ZXh0IHtcbiAgICBsZXQgZmluYWxDb250ZXh0ID0gdGhpcy5fYmVmb3JlTmF2aWdhdGU/Lih7IC4uLnVwZGF0ZWRDb250ZXh0IH0pO1xuXG4gICAgLy8gVGhpcyBibG9jayBpcyB0byBjYXRjaCB1c2VycyBub3QgcmV0dXJuaW5nIGEgdHJhbnNhY3Rpb24gY29udGV4dFxuICAgIGlmICghZmluYWxDb250ZXh0KSB7XG4gICAgICBsb2dnZXIuZXJyb3IoXG4gICAgICAgIGBbUmVhY3ROYXZpZ2F0aW9uSW5zdHJ1bWVudGF0aW9uXSBiZWZvcmVOYXZpZ2F0ZSByZXR1cm5lZCAke2ZpbmFsQ29udGV4dH0sIHJldHVybiBjb250ZXh0LnNhbXBsZWQgPSBmYWxzZSB0byBub3Qgc2VuZCB0cmFuc2FjdGlvbi5gLFxuICAgICAgKTtcblxuICAgICAgZmluYWxDb250ZXh0ID0ge1xuICAgICAgICAuLi51cGRhdGVkQ29udGV4dCxcbiAgICAgICAgc2FtcGxlZDogZmFsc2UsXG4gICAgICB9O1xuICAgIH1cblxuICAgIC8vIE5vdGU6IGZpbmFsQ29udGV4dC5zYW1wbGVkIHdpbGwgYmUgZmFsc2UgYXQgdGhpcyBwb2ludCBvbmx5IGlmIHRoZSB1c2VyIHNldHMgaXQgdG8gYmUgc28gaW4gYmVmb3JlTmF2aWdhdGUuXG4gICAgaWYgKGZpbmFsQ29udGV4dC5zYW1wbGVkID09PSBmYWxzZSkge1xuICAgICAgbG9nZ2VyLmxvZyhcbiAgICAgICAgYFtSZWFjdE5hdmlnYXRpb25JbnN0cnVtZW50YXRpb25dIFdpbGwgbm90IHNlbmQgdHJhbnNhY3Rpb24gXCIke2ZpbmFsQ29udGV4dC5uYW1lfVwiIGR1ZSB0byBiZWZvcmVOYXZpZ2F0ZS5gLFxuICAgICAgKTtcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gQ2xlYXIgdGhlIHRpbWVvdXQgc28gdGhlIHRyYW5zYWN0aW9uIGRvZXMgbm90IGdldCBjYW5jZWxsZWQuXG4gICAgICB0aGlzLl9jbGVhclN0YXRlQ2hhbmdlVGltZW91dCgpO1xuICAgIH1cblxuICAgIHJldHVybiBmaW5hbENvbnRleHQ7XG4gIH1cblxuICAvKiogUHVzaGVzIGEgcmVjZW50IHJvdXRlIGtleSwgYW5kIHJlbW92ZXMgZWFybGllciByb3V0ZXMgd2hlbiB0aGVyZSBpcyBncmVhdGVyIHRoYW4gdGhlIG1heCBsZW5ndGggKi9cbiAgcHJpdmF0ZSBfcHVzaFJlY2VudFJvdXRlS2V5ID0gKGtleTogc3RyaW5nKTogdm9pZCA9PiB7XG4gICAgdGhpcy5fcmVjZW50Um91dGVLZXlzLnB1c2goa2V5KTtcblxuICAgIGlmICh0aGlzLl9yZWNlbnRSb3V0ZUtleXMubGVuZ3RoID4gdGhpcy5fbWF4UmVjZW50Um91dGVMZW4pIHtcbiAgICAgIHRoaXMuX3JlY2VudFJvdXRlS2V5cyA9IHRoaXMuX3JlY2VudFJvdXRlS2V5cy5zbGljZSh0aGlzLl9yZWNlbnRSb3V0ZUtleXMubGVuZ3RoIC0gdGhpcy5fbWF4UmVjZW50Um91dGVMZW4pO1xuICAgIH1cbiAgfTtcblxuICAvKiogQ2FuY2VscyB0aGUgbGF0ZXN0IHRyYW5zYWN0aW9uIHNvIGl0IGRvZXMgbm90IGdldCBzZW50IHRvIFNlbnRyeS4gKi9cbiAgcHJpdmF0ZSBfZGlzY2FyZExhdGVzdFRyYW5zYWN0aW9uKCk6IHZvaWQge1xuICAgIGlmICh0aGlzLl9sYXRlc3RUcmFuc2FjdGlvbikge1xuICAgICAgdGhpcy5fbGF0ZXN0VHJhbnNhY3Rpb24uc2FtcGxlZCA9IGZhbHNlO1xuICAgICAgdGhpcy5fbGF0ZXN0VHJhbnNhY3Rpb24uZmluaXNoKCk7XG4gICAgICB0aGlzLl9sYXRlc3RUcmFuc2FjdGlvbiA9IHVuZGVmaW5lZDtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICpcbiAgICovXG4gIHByaXZhdGUgX2NsZWFyU3RhdGVDaGFuZ2VUaW1lb3V0KCk6IHZvaWQge1xuICAgIGlmICh0eXBlb2YgdGhpcy5fc3RhdGVDaGFuZ2VUaW1lb3V0ICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgY2xlYXJUaW1lb3V0KHRoaXMuX3N0YXRlQ2hhbmdlVGltZW91dCk7XG4gICAgICB0aGlzLl9zdGF0ZUNoYW5nZVRpbWVvdXQgPSB1bmRlZmluZWQ7XG4gICAgfVxuICB9XG59XG5cbi8qKlxuICogQmFja3dhcmRzIGNvbXBhdGliaWxpdHkgYWxpYXMgZm9yIFJlYWN0TmF2aWdhdGlvbkluc3RydW1lbnRhdGlvblxuICogQGRlcHJlY2F0ZWQgVXNlIFJlYWN0TmF2aWdhdGlvbkluc3RydW1lbnRhdGlvblxuICovXG5leHBvcnQgY29uc3QgUmVhY3ROYXZpZ2F0aW9uVjVJbnN0cnVtZW50YXRpb24gPSBSZWFjdE5hdmlnYXRpb25JbnN0cnVtZW50YXRpb247XG5cbmV4cG9ydCBjb25zdCBCTEFOS19UUkFOU0FDVElPTl9DT05URVhUID0ge1xuICBuYW1lOiAnUm91dGUgQ2hhbmdlJyxcbiAgb3A6ICduYXZpZ2F0aW9uJyxcbiAgdGFnczoge1xuICAgICdyb3V0aW5nLmluc3RydW1lbnRhdGlvbic6IFJlYWN0TmF2aWdhdGlvbkluc3RydW1lbnRhdGlvbi5pbnN0cnVtZW50YXRpb25OYW1lLFxuICB9LFxuICBkYXRhOiB7fSxcbn07XG4iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBRUEsSUFBQUEsTUFBQSxHQUFBQyxPQUFBO0FBRUEsSUFBQUMsVUFBQSxHQUFBRCxPQUFBO0FBRUEsSUFBQUUsdUJBQUEsR0FBQUYsT0FBQTtBQUVBLElBQUFHLE9BQUEsR0FBQUgsT0FBQTtBQUF3RyxTQUFBSSxhQUFBQyxPQUFBLFFBQUFDLHlCQUFBLEdBQUFDLHlCQUFBLG9CQUFBQyxxQkFBQSxRQUFBQyxLQUFBLE9BQUFDLGdCQUFBLENBQUFDLE9BQUEsRUFBQU4sT0FBQSxHQUFBTyxNQUFBLE1BQUFOLHlCQUFBLFFBQUFPLFNBQUEsT0FBQUgsZ0JBQUEsQ0FBQUMsT0FBQSxRQUFBRyxXQUFBLEVBQUFGLE1BQUEsR0FBQUcsT0FBQSxDQUFBQyxTQUFBLENBQUFQLEtBQUEsRUFBQVEsU0FBQSxFQUFBSixTQUFBLFlBQUFELE1BQUEsR0FBQUgsS0FBQSxDQUFBUyxLQUFBLE9BQUFELFNBQUEsZ0JBQUFFLDJCQUFBLENBQUFSLE9B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