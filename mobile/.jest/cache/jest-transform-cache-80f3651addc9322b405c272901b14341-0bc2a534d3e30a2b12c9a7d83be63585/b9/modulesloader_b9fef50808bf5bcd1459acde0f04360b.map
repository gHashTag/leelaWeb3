{"version":3,"names":["_utils","require","_wrapper","ModulesLoader","_classCallCheck2","default","name","id","_createClass2","key","value","setupOnce","addGlobalEventProcessor","_this","isSetup","modules","event","__awaiter","NATIVE","fetchModules","e","logger","log","Object","assign","exports"],"sources":["../../../src/js/integrations/modulesloader.ts"],"sourcesContent":["import type { Event, EventProcessor, Integration } from '@sentry/types';\nimport { logger } from '@sentry/utils';\n\nimport { NATIVE } from '../wrapper';\n\n/** Loads runtime JS modules from prepared file. */\nexport class ModulesLoader implements Integration {\n  /**\n   * @inheritDoc\n   */\n  public static id: string = 'ModulesLoader';\n\n  /**\n   * @inheritDoc\n   */\n  public name: string = ModulesLoader.id;\n\n  /**\n   * @inheritDoc\n   */\n  public setupOnce(addGlobalEventProcessor: (e: EventProcessor) => void): void {\n    let isSetup = false;\n    let modules: Record<string, string> | null;\n\n    addGlobalEventProcessor(async (event: Event) => {\n      if (!isSetup) {\n        try {\n          modules = await NATIVE.fetchModules();\n        } catch (e) {\n          logger.log(`Failed to get modules from native: ${e}`);\n        }\n        isSetup = true;\n      }\n      if (modules) {\n        event.modules = {\n          ...modules,\n          ...event.modules,\n        };\n      }\n      return event;\n    });\n  }\n}\n"],"mappings":";;;;;;;;AACA,IAAAA,MAAA,GAAAC,OAAA;AAEA,IAAAC,QAAA,GAAAD,OAAA;AAAoC,IAGvBE,aAAa;EAA1B,SAAAA,cAAA;IAAA,IAAAC,gBAAA,CAAAC,OAAA,QAAAF,aAAA;IASS,KAAAG,IAAI,GAAWH,aAAa,CAACI,EAAE;EA2BxC;EAAC,IAAAC,aAAA,CAAAH,OAAA,EAAAF,aAAA;IAAAM,GAAA;IAAAC,KAAA,EAtBQ,SAAAC,UAAUC,uBAAoD;MAAA,IAAAC,KAAA;MACnE,IAAIC,OAAO,GAAG,KAAK;MACnB,IAAIC,OAAsC;MAE1CH,uBAAuB,CAAC,UAAOI,KAAY;QAAA,OAAI,IAAAC,gBAAA,EAAAJ,KAAA;UAC7C,IAAI,CAACC,OAAO,EAAE;YACZ,IAAI;cACFC,OAAO,GAAG,MAAMG,eAAM,CAACC,YAAY,EAAE;aACtC,CAAC,OAAOC,CAAC,EAAE;cACVC,aAAM,CAACC,GAAG,CAAC,sCAAsCF,CAAC,EAAE,CAAC;;YAEvDN,OAAO,GAAG,IAAI;;UAEhB,IAAIC,OAAO,EAAE;YACXC,KAAK,CAACD,OAAO,GAAAQ,MAAA,CAAAC,MAAA,CAAAD,MAAA,CAAAC,MAAA,KACRT,OAAO,GACPC,KAAK,CAACD,OAAO,CACjB;;UAEH,OAAOC,KAAK;QACd,CAAC;MAAA,EAAC;IACJ;EAAC;EAAA,OAAAb,aAAA;AAAA;AAAAsB,OAAA,CAAAtB,aAAA,GAAAA,aAAA;AA/BaA,aAAA,CAAAI,EAAE,GAAW,eAAe"}