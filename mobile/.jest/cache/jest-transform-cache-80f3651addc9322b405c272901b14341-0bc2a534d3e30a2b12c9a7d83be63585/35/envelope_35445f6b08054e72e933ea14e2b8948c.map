{"version":3,"names":["_utils","require","header","exports","items","createUserFeedbackEnvelope","feedback","_ref","metadata","tunnel","dsn","headers","Object","assign","event_id","sent_at","Date","toISOString","sdk","name","version","dsnToString","item","createUserFeedbackEnvelopeItem","createEnvelope","feedbackHeaders","type"],"sources":["../../../src/js/utils/envelope.ts"],"sourcesContent":["import type { DsnComponents, EventEnvelope, SdkMetadata, UserFeedback, UserFeedbackItem } from '@sentry/types';\nimport { createEnvelope, dsnToString } from '@sentry/utils';\n\nexport const header = 0;\nexport const items = 1;\n\n/**\n * Creates an envelope from a user feedback.\n */\nexport function createUserFeedbackEnvelope(\n  feedback: UserFeedback,\n  {\n    metadata,\n    tunnel,\n    dsn,\n  }: {\n    metadata: SdkMetadata | undefined;\n    tunnel: string | undefined;\n    dsn: DsnComponents | undefined;\n  },\n): EventEnvelope {\n  const headers: EventEnvelope[0] = {\n    event_id: feedback.event_id,\n    sent_at: new Date().toISOString(),\n    ...(metadata &&\n      metadata.sdk && {\n        sdk: {\n          name: metadata.sdk.name,\n          version: metadata.sdk.version,\n        },\n      }),\n    ...(!!tunnel && !!dsn && { dsn: dsnToString(dsn) }),\n  };\n  const item = createUserFeedbackEnvelopeItem(feedback);\n\n  return createEnvelope(headers, [item]);\n}\n\nfunction createUserFeedbackEnvelopeItem(feedback: UserFeedback): UserFeedbackItem {\n  const feedbackHeaders: UserFeedbackItem[0] = {\n    type: 'user_report',\n  };\n  return [feedbackHeaders, feedback];\n}\n"],"mappings":";;;;;AACA,IAAAA,MAAA,GAAAC,OAAA;AAEO,IAAMC,MAAM,GAAG,CAAC;AAACC,OAAA,CAAAD,MAAA,GAAAA,MAAA;AACjB,IAAME,KAAK,GAAG,CAAC;AAACD,OAAA,CAAAC,KAAA,GAAAA,KAAA;AAKjB,SAAUC,0BAA0BA,CACxCC,QAAsB,EAAAC,IAAA,EASrB;EAAA,IAPCC,QAAQ,GAAAD,IAAA,CAARC,QAAQ;IACRC,MAAM,GAAAF,IAAA,CAANE,MAAM;IACNC,GAAG,GAAAH,IAAA,CAAHG,GAAG;EAOL,IAAMC,OAAO,GAAAC,MAAA,CAAAC,MAAA,CAAAD,MAAA,CAAAC,MAAA;IACXC,QAAQ,EAAER,QAAQ,CAACQ,QAAQ;IAC3BC,OAAO,EAAE,IAAIC,IAAI,EAAE,CAACC,WAAW;EAAE,GAC7BT,QAAQ,IACVA,QAAQ,CAACU,GAAG,IAAI;IACdA,GAAG,EAAE;MACHC,IAAI,EAAEX,QAAQ,CAACU,GAAG,CAACC,IAAI;MACvBC,OAAO,EAAEZ,QAAQ,CAACU,GAAG,CAACE;;GAExB,GACA,CAAC,CAACX,MAAM,IAAI,CAAC,CAACC,GAAG,IAAI;IAAEA,GAAG,EAAE,IAAAW,kBAAW,EAACX,GAAG;EAAC,CAAG,CACpD;EACD,IAAMY,IAAI,GAAGC,8BAA8B,CAACjB,QAAQ,CAAC;EAErD,OAAO,IAAAkB,qBAAc,EAACb,OAAO,EAAE,CAACW,IAAI,CAAC,CAAC;AACxC;AAEA,SAASC,8BAA8BA,CAACjB,QAAsB;EAC5D,IAAMmB,eAAe,GAAwB;IAC3CC,IAAI,EAAE;GACP;EACD,OAAO,CAACD,eAAe,EAAEnB,QAAQ,CAAC;AACpC"}