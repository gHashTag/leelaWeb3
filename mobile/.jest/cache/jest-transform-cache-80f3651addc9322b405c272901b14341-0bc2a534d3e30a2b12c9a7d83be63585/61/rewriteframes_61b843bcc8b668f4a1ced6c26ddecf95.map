{"version":3,"names":["_integrations","require","_reactNative","_environment","ANDROID_DEFAULT_BUNDLE_NAME","exports","IOS_DEFAULT_BUNDLE_NAME","createReactNativeRewriteFrames","RewriteFrames","iteratee","frame","filename","abs_path","replace","isExpo","Platform","OS","appPrefix","indexOf"],"sources":["../../../src/js/integrations/rewriteframes.ts"],"sourcesContent":["import { RewriteFrames } from '@sentry/integrations';\nimport type { StackFrame } from '@sentry/types';\nimport { Platform } from 'react-native';\n\nimport { isExpo } from '../utils/environment';\n\nexport const ANDROID_DEFAULT_BUNDLE_NAME = 'app:///index.android.bundle';\nexport const IOS_DEFAULT_BUNDLE_NAME = 'app:///main.jsbundle';\n\n/**\n * Creates React Native default rewrite frames integration\n * which appends app:// to the beginning of the filename\n * and removes file://, 'address at' prefixes, CodePush postfix,\n * and Expo bundle postfix.\n */\nexport function createReactNativeRewriteFrames(): RewriteFrames {\n  return new RewriteFrames({\n    iteratee: (frame: StackFrame) => {\n      if (!frame.filename) {\n        return frame;\n      }\n      delete frame.abs_path;\n\n      frame.filename = frame.filename\n        .replace(/^file:\\/\\//, '')\n        .replace(/^address at /, '')\n        .replace(/^.*\\/[^.]+(\\.app|CodePush|.*(?=\\/))/, '');\n\n      if (frame.filename === '[native code]' || frame.filename === 'native') {\n        return frame;\n      }\n\n      // Expo adds hash to the end of bundle names\n      if (isExpo() && Platform.OS === 'android') {\n        frame.filename = ANDROID_DEFAULT_BUNDLE_NAME;\n        return frame;\n      }\n\n      if (isExpo() && Platform.OS === 'ios') {\n        frame.filename = IOS_DEFAULT_BUNDLE_NAME;\n        return frame;\n      }\n\n      const appPrefix = 'app://';\n      // We always want to have a triple slash\n      frame.filename =\n        frame.filename.indexOf('/') === 0 ? `${appPrefix}${frame.filename}` : `${appPrefix}/${frame.filename}`;\n      return frame;\n    },\n  });\n}\n"],"mappings":";;;;;AAAA,IAAAA,aAAA,GAAAC,OAAA;AAEA,IAAAC,YAAA,GAAAD,OAAA;AAEA,IAAAE,YAAA,GAAAF,OAAA;AAEO,IAAMG,2BAA2B,GAAG,6BAA6B;AAACC,OAAA,CAAAD,2BAAA,GAAAA,2BAAA;AAClE,IAAME,uBAAuB,GAAG,sBAAsB;AAACD,OAAA,CAAAC,uBAAA,GAAAA,uBAAA;AAQxD,SAAUC,8BAA8BA,CAAA;EAC5C,OAAO,IAAIC,2BAAa,CAAC;IACvBC,QAAQ,EAAE,SAAAA,SAACC,KAAiB,EAAI;MAC9B,IAAI,CAACA,KAAK,CAACC,QAAQ,EAAE;QACnB,OAAOD,KAAK;;MAEd,OAAOA,KAAK,CAACE,QAAQ;MAErBF,KAAK,CAACC,QAAQ,GAAGD,KAAK,CAACC,QAAQ,CAC5BE,OAAO,CAAC,YAAY,EAAE,EAAE,CAAC,CACzBA,OAAO,CAAC,cAAc,EAAE,EAAE,CAAC,CAC3BA,OAAO,CAAC,qCAAqC,EAAE,EAAE,CAAC;MAErD,IAAIH,KAAK,CAACC,QAAQ,KAAK,eAAe,IAAID,KAAK,CAACC,QAAQ,KAAK,QAAQ,EAAE;QACrE,OAAOD,KAAK;;MAId,IAAI,IAAAI,mBAAM,GAAE,IAAIC,qBAAQ,CAACC,EAAE,KAAK,SAAS,EAAE;QACzCN,KAAK,CAACC,QAAQ,GAAGP,2BAA2B;QAC5C,OAAOM,KAAK;;MAGd,IAAI,IAAAI,mBAAM,GAAE,IAAIC,qBAAQ,CAACC,EAAE,KAAK,KAAK,EAAE;QACrCN,KAAK,CAACC,QAAQ,GAAGL,uBAAuB;QACxC,OAAOI,KAAK;;MAGd,IAAMO,SAAS,GAAG,QAAQ;MAE1BP,KAAK,CAACC,QAAQ,GACZD,KAAK,CAACC,QAAQ,CAACO,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,GAAG,GAAGD,SAAS,GAAGP,KAAK,CAACC,QAAQ,EAAE,GAAG,GAAGM,SAAS,IAAIP,KAAK,CAACC,QAAQ,EAAE;MACxG,OAAOD,KAAK;IACd;GACD,CAAC;AACJ"}