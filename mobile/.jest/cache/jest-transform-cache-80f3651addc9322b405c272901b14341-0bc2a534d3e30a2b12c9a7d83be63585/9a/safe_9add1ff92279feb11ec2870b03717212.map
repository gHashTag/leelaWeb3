{"version":3,"names":["_utils","require","safeFactory","danger","options","arguments","length","undefined","apply","error","logger","loggerMessage","name","safeTracesSampler","tracesSampler"],"sources":["../../../src/js/utils/safe.ts"],"sourcesContent":["import { logger } from '@sentry/utils';\n\nimport type { ReactNativeOptions } from '../options';\n\ntype DangerTypesWithoutCallSignature =\n  // eslint-disable-next-line @typescript-eslint/ban-types\n  Object | null | undefined;\n\n/**\n * Returns callback factory wrapped with try/catch\n * or the original passed value is it's not a function.\n *\n * If the factory fails original data are returned as it.\n * They might be partially modified by the failed function.\n */\nexport function safeFactory<A extends [R, ...unknown[]], R, T extends DangerTypesWithoutCallSignature>(\n  danger: ((...args: A) => R) | T,\n  options: {\n    loggerMessage?: string;\n  } = {},\n): ((...args: A) => R) | T {\n  if (typeof danger === 'function') {\n    return (...args) => {\n      try {\n        return danger(...args);\n      } catch (error) {\n        logger.error(\n          options.loggerMessage ? options.loggerMessage : `The ${danger.name} callback threw an error`,\n          error,\n        );\n        return args[0];\n      }\n    };\n  } else {\n    return danger;\n  }\n}\n\ntype TracesSampler = Required<ReactNativeOptions>['tracesSampler'];\n\n/**\n * Returns sage tracesSampler that returns 0 if the original failed.\n */\nexport function safeTracesSampler(\n  tracesSampler: ReactNativeOptions['tracesSampler'],\n): ReactNativeOptions['tracesSampler'] {\n  if (tracesSampler) {\n    return (...args: Parameters<TracesSampler>): ReturnType<TracesSampler> => {\n      try {\n        return tracesSampler(...args);\n      } catch (error) {\n        logger.error('The tracesSampler callback threw an error', error);\n        return 0;\n      }\n    };\n  } else {\n    return tracesSampler;\n  }\n}\n"],"mappings":";;;;;AAAA,IAAAA,MAAA,GAAAC,OAAA;AAeM,SAAUC,WAAWA,CACzBC,MAA+B,EAGzB;EAAA,IAFNC,OAAA,GAAAC,SAAA,CAAAC,MAAA,QAAAD,SAAA,QAAAE,SAAA,GAAAF,SAAA,MAEI,EAAE;EAEN,IAAI,OAAOF,MAAM,KAAK,UAAU,EAAE;IAChC,OAAO,YAAY;MACjB,IAAI;QACF,OAAOA,MAAM,CAAAK,KAAA,SAAAH,SAAQ,CAAC;OACvB,CAAC,OAAOI,KAAK,EAAE;QACdC,aAAM,CAACD,KAAK,CACVL,OAAO,CAACO,aAAa,GAAGP,OAAO,CAACO,aAAa,GAAG,OAAOR,MAAM,CAACS,IAAI,0BAA0B,EAC5FH,KAAK,CACN;QACD,OAAAJ,SAAA,CAAAC,MAAA,QAAAC,SAAA,GAAAF,SAAA;;IAEJ,CAAC;GACF,MAAM;IACL,OAAOF,MAAM;;AAEjB;AAOM,SAAUU,iBAAiBA,CAC/BC,aAAkD;EAElD,IAAIA,aAAa,EAAE;IACjB,OAAO,YAAkE;MACvE,IAAI;QACF,OAAOA,aAAa,CAAAN,KAAA,SAAAH,SAAQ,CAAC;OAC9B,CAAC,OAAOI,KAAK,EAAE;QACdC,aAAM,CAACD,KAAK,CAAC,2CAA2C,EAAEA,KAAK,CAAC;QAChE,OAAO,CAAC;;IAEZ,CAAC;GACF,MAAM;IACL,OAAOK,aAAa;;AAExB"}