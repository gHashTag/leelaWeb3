{"version":3,"names":["_react","_interopRequireWildcard","require","_reactNative","_propTypes","_interopRequireDefault","_parser","_getUniqueID","_hasParents","_openUrl","_tokensToAST","_renderRules","_AstRenderer","_markdownIt","_removeTextStyleProps","_styles","_stringToTokens","_reactNativeFitImage","_textStyleProps","_jsxRuntime","_this","_jsxFileName","_getRequireWildcardCache","nodeInterop","WeakMap","cacheBabelInterop","cacheNodeInterop","obj","__esModule","default","cache","has","get","newObj","hasPropertyDescriptor","Object","defineProperty","getOwnPropertyDescriptor","key","prototype","hasOwnProperty","call","desc","set","getStyle","mergeStyle","style","useStyles","keys","forEach","value","assign","StyleSheet","flatten","styles","removeTextStyleProps","create","getRenderer","renderer","rules","onLinkPress","maxTopLevelChildren","topLevelMaxExceededItem","allowedImageHandlers","defaultImageHandler","debugPrintTree","console","warn","AstRenderer","Error","renderRules","Markdown","React","memo","_ref","children","_ref$renderer","_ref$rules","_ref$style","_ref$mergeStyle","_ref$markdownit","markdownit","MarkdownIt","typographer","_ref$maxTopLevelChild","_ref$topLevelMaxExcee","jsx","Text","_ref$allowedImageHand","_ref$defaultImageHand","_ref$debugPrintTree","momoizedRenderer","useMemo","momoizedParser","parser","render","propTypes","PropTypes","oneOfType","node","array","isRequired","func","instanceOf","number","any","props","propName","componentName","invalidProps","prop","filter","length","join","bool","arrayOf","string","_default","exports"],"sources":["index.js"],"sourcesContent":["/**\n * Base Markdown component\n * @author Mient-jan Stelling + contributors\n */\n\nimport React, {useMemo} from 'react';\nimport {Text, StyleSheet} from 'react-native';\nimport PropTypes from 'prop-types';\nimport parser from './lib/parser';\nimport getUniqueID from './lib/util/getUniqueID';\nimport hasParents from './lib/util/hasParents';\nimport openUrl from './lib/util/openUrl';\nimport tokensToAST from './lib/util/tokensToAST';\nimport renderRules from './lib/renderRules';\nimport AstRenderer from './lib/AstRenderer';\nimport MarkdownIt from 'markdown-it';\nimport removeTextStyleProps from './lib/util/removeTextStyleProps';\nimport {styles} from './lib/styles';\nimport {stringToTokens} from './lib/util/stringToTokens';\nimport FitImage from 'react-native-fit-image';\nimport textStyleProps from './lib/data/textStyleProps';\n\nexport {\n  getUniqueID,\n  openUrl,\n  hasParents,\n  renderRules,\n  AstRenderer,\n  parser,\n  stringToTokens,\n  tokensToAST,\n  MarkdownIt,\n  styles,\n  removeTextStyleProps,\n  FitImage,\n  textStyleProps,\n};\n\n// we use StyleSheet.flatten here to make sure we have an object, in case someone\n// passes in a StyleSheet.create result to the style prop\nconst getStyle = (mergeStyle, style) => {\n  let useStyles = {};\n\n  if (mergeStyle === true && style !== null) {\n    // make sure we get anything user defuned\n    Object.keys(style).forEach((value) => {\n      useStyles[value] = {\n        ...StyleSheet.flatten(style[value]),\n      };\n    });\n\n    // combine any existing styles\n    Object.keys(styles).forEach((value) => {\n      useStyles[value] = {\n        ...styles[value],\n        ...StyleSheet.flatten(style[value]),\n      };\n    });\n  } else {\n    useStyles = {\n      ...styles,\n    };\n\n    if (style !== null) {\n      Object.keys(style).forEach((value) => {\n        useStyles[value] = {\n          ...StyleSheet.flatten(style[value]),\n        };\n      });\n    }\n  }\n\n  Object.keys(useStyles).forEach((value) => {\n    useStyles['_VIEW_SAFE_' + value] = removeTextStyleProps(useStyles[value]);\n  });\n\n  return StyleSheet.create(useStyles);\n};\n\nconst getRenderer = (\n  renderer,\n  rules,\n  style,\n  mergeStyle,\n  onLinkPress,\n  maxTopLevelChildren,\n  topLevelMaxExceededItem,\n  allowedImageHandlers,\n  defaultImageHandler,\n  debugPrintTree,\n) => {\n  if (renderer && rules) {\n    console.warn(\n      'react-native-markdown-display you are using renderer and rules at the same time. This is not possible, props.rules is ignored',\n    );\n  }\n\n  if (renderer && style) {\n    console.warn(\n      'react-native-markdown-display you are using renderer and style at the same time. This is not possible, props.style is ignored',\n    );\n  }\n\n  // these checks are here to prevent extra overhead.\n  if (renderer) {\n    if (!(typeof renderer === 'function') || renderer instanceof AstRenderer) {\n      return renderer;\n    } else {\n      throw new Error(\n        'Provided renderer is not compatible with function or AstRenderer. please change',\n      );\n    }\n  } else {\n    let useStyles = getStyle(mergeStyle, style);\n\n    return new AstRenderer(\n      {\n        ...renderRules,\n        ...(rules || {}),\n      },\n      useStyles,\n      onLinkPress,\n      maxTopLevelChildren,\n      topLevelMaxExceededItem,\n      allowedImageHandlers,\n      defaultImageHandler,\n      debugPrintTree,\n    );\n  }\n};\n\nconst Markdown = React.memo(\n  ({\n    children,\n    renderer = null,\n    rules = null,\n    style = null,\n    mergeStyle = true,\n    markdownit = MarkdownIt({\n      typographer: true,\n    }),\n    onLinkPress,\n    maxTopLevelChildren = null,\n    topLevelMaxExceededItem = <Text key=\"dotdotdot\">...</Text>,\n    allowedImageHandlers = [\n      'data:image/png;base64',\n      'data:image/gif;base64',\n      'data:image/jpeg;base64',\n      'https://',\n      'http://',\n    ],\n    defaultImageHandler = 'https://',\n    debugPrintTree = false,\n  }) => {\n    const momoizedRenderer = useMemo(\n      () =>\n        getRenderer(\n          renderer,\n          rules,\n          style,\n          mergeStyle,\n          onLinkPress,\n          maxTopLevelChildren,\n          topLevelMaxExceededItem,\n          allowedImageHandlers,\n          defaultImageHandler,\n          debugPrintTree,\n        ),\n      [\n        maxTopLevelChildren,\n        onLinkPress,\n        renderer,\n        rules,\n        style,\n        mergeStyle,\n        topLevelMaxExceededItem,\n        allowedImageHandlers,\n        defaultImageHandler,\n        debugPrintTree,\n      ],\n    );\n\n    const momoizedParser = useMemo(() => markdownit, [markdownit]);\n\n    return parser(children, momoizedRenderer.render, momoizedParser);\n  },\n);\n\nMarkdown.propTypes = {\n  children: PropTypes.oneOfType([PropTypes.node, PropTypes.array]).isRequired,\n  renderer: PropTypes.oneOfType([\n    PropTypes.func,\n    PropTypes.instanceOf(AstRenderer),\n  ]),\n  onLinkPress: PropTypes.func,\n  maxTopLevelChildren: PropTypes.number,\n  topLevelMaxExceededItem: PropTypes.any,\n  rules: (props, propName, componentName) => {\n    let invalidProps = [];\n    const prop = props[propName];\n\n    if (!prop) {\n      return;\n    }\n\n    if (typeof prop === 'object') {\n      invalidProps = Object.keys(prop).filter(\n        (key) => typeof prop[key] !== 'function',\n      );\n    }\n\n    if (typeof prop !== 'object') {\n      return new Error(\n        `Invalid prop \\`${propName}\\` supplied to \\`${componentName}\\`. Must be of shape {[index:string]:function} `,\n      );\n    } else if (invalidProps.length > 0) {\n      return new Error(\n        `Invalid prop \\`${propName}\\` supplied to \\`${componentName}\\`. These ` +\n          `props are not of type function \\`${invalidProps.join(', ')}\\` `,\n      );\n    }\n  },\n  markdownit: PropTypes.instanceOf(MarkdownIt),\n  style: PropTypes.any,\n  mergeStyle: PropTypes.bool,\n  allowedImageHandlers: PropTypes.arrayOf(PropTypes.string),\n  defaultImageHandler: PropTypes.string,\n  debugPrintTree: PropTypes.bool,\n};\n\nexport default Markdown;\n"],"mappings":"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"}