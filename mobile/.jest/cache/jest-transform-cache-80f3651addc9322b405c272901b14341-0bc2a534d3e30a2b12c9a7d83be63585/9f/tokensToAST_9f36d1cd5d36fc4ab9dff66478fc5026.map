{"version":3,"names":["_getUniqueID","_interopRequireDefault","require","_getTokenTypeByToken","createNode","token","tokenIndex","type","getTokenTypeByToken","content","attributes","attrs","reduce","prev","curr","_curr","_slicedToArray2","default","name","value","Object","assign","_defineProperty2","sourceType","sourceInfo","info","sourceMeta","meta","block","markup","key","getUniqueID","index","children","tokensToAST","tokens","stack","length","i","astNode","nesting","push","pop"],"sources":["tokensToAST.js"],"sourcesContent":["import getUniqueID from './getUniqueID';\nimport getTokenTypeByToken from './getTokenTypeByToken';\n\n/**\n *\n * @param {{type: string, tag:string, content: string, children: *, attrs: Array, meta, info, block: boolean}} token\n * @param {number} tokenIndex\n * @return {{type: string, content, tokenIndex: *, index: number, attributes: {}, children: *}}\n */\nfunction createNode(token, tokenIndex) {\n  const type = getTokenTypeByToken(token);\n  const content = token.content;\n\n  let attributes = {};\n\n  if (token.attrs) {\n    attributes = token.attrs.reduce((prev, curr) => {\n      const [name, value] = curr;\n      return {...prev, [name]: value};\n    }, {});\n  }\n\n  return {\n    type,\n    sourceType: token.type,\n    sourceInfo: token.info,\n    sourceMeta: token.meta,\n    block: token.block,\n    markup: token.markup,\n    key: getUniqueID() + '_' + type,\n    content,\n    tokenIndex,\n    index: 0,\n    attributes,\n    children: tokensToAST(token.children),\n  };\n}\n\n/**\n *\n * @param {Array<{type: string, tag:string, content: string, children: *, attrs: Array}>}tokens\n * @return {Array}\n */\nexport default function tokensToAST(tokens) {\n  let stack = [];\n  let children = [];\n\n  if (!tokens || tokens.length === 0) {\n    return [];\n  }\n\n  for (let i = 0; i < tokens.length; i++) {\n    const token = tokens[i];\n    const astNode = createNode(token, i);\n\n    if (\n      !(\n        astNode.type === 'text' &&\n        astNode.children.length === 0 &&\n        astNode.content === ''\n      )\n    ) {\n      astNode.index = children.length;\n\n      if (token.nesting === 1) {\n        children.push(astNode);\n        stack.push(children);\n        children = astNode.children;\n      } else if (token.nesting === -1) {\n        children = stack.pop();\n      } else if (token.nesting === 0) {\n        children.push(astNode);\n      }\n    }\n  }\n\n  return children;\n}\n"],"mappings":";;;;;;;AAAA,IAAAA,YAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,oBAAA,GAAAF,sBAAA,CAAAC,OAAA;AAQA,SAASE,UAAUA,CAACC,KAAK,EAAEC,UAAU,EAAE;EACrC,IAAMC,IAAI,GAAG,IAAAC,4BAAmB,EAACH,KAAK,CAAC;EACvC,IAAMI,OAAO,GAAGJ,KAAK,CAACI,OAAO;EAE7B,IAAIC,UAAU,GAAG,CAAC,CAAC;EAEnB,IAAIL,KAAK,CAACM,KAAK,EAAE;IACfD,UAAU,GAAGL,KAAK,CAACM,KAAK,CAACC,MAAM,CAAC,UAACC,IAAI,EAAEC,IAAI,EAAK;MAC9C,IAAAC,KAAA,OAAAC,eAAA,CAAAC,OAAA,EAAsBH,IAAI;QAAnBI,IAAI,GAAAH,KAAA;QAAEI,KAAK,GAAAJ,KAAA;MAClB,OAAAK,MAAA,CAAAC,MAAA,KAAWR,IAAI,MAAAS,gBAAA,CAAAL,OAAA,MAAGC,IAAI,EAAGC,KAAK;IAChC,CAAC,EAAE,CAAC,CAAC,CAAC;EACR;EAEA,OAAO;IACLZ,IAAI,EAAJA,IAAI;IACJgB,UAAU,EAAElB,KAAK,CAACE,IAAI;IACtBiB,UAAU,EAAEnB,KAAK,CAACoB,IAAI;IACtBC,UAAU,EAAErB,KAAK,CAACsB,IAAI;IACtBC,KAAK,EAAEvB,KAAK,CAACuB,KAAK;IAClBC,MAAM,EAAExB,KAAK,CAACwB,MAAM;IACpBC,GAAG,EAAE,IAAAC,oBAAW,EAAC,CAAC,GAAG,GAAG,GAAGxB,IAAI;IAC/BE,OAAO,EAAPA,OAAO;IACPH,UAAU,EAAVA,UAAU;IACV0B,KAAK,EAAE,CAAC;IACRtB,UAAU,EAAVA,UAAU;IACVuB,QAAQ,EAAEC,WAAW,CAAC7B,KAAK,CAAC4B,QAAQ;EACtC,CAAC;AACH;AAOe,SAASC,WAAWA,CAACC,MAAM,EAAE;EAC1C,IAAIC,KAAK,GAAG,EAAE;EACd,IAAIH,QAAQ,GAAG,EAAE;EAEjB,IAAI,CAACE,MAAM,IAAIA,MAAM,CAACE,MAAM,KAAK,CAAC,EAAE;IAClC,OAAO,EAAE;EACX;EAEA,KAAK,IAAIC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGH,MAAM,CAACE,MAAM,EAAEC,CAAC,EAAE,EAAE;IACtC,IAAMjC,KAAK,GAAG8B,MAAM,CAACG,CAAC,CAAC;IACvB,IAAMC,OAAO,GAAGnC,UAAU,CAACC,KAAK,EAAEiC,CAAC,CAAC;IAEpC,IACE,EACEC,OAAO,CAAChC,IAAI,KAAK,MAAM,IACvBgC,OAAO,CAACN,QAAQ,CAACI,MAAM,KAAK,CAAC,IAC7BE,OAAO,CAAC9B,OAAO,KAAK,EAAE,CACvB,EACD;MACA8B,OAAO,CAACP,KAAK,GAAGC,QAAQ,CAACI,MAAM;MAE/B,IAAIhC,KAAK,CAACmC,OAAO,KAAK,CAAC,EAAE;QACvBP,QAAQ,CAACQ,IAAI,CAACF,OAAO,CAAC;QACtBH,KAAK,CAACK,IAAI,CAACR,QAAQ,CAAC;QACpBA,QAAQ,GAAGM,OAAO,CAACN,QAAQ;MAC7B,CAAC,MAAM,IAAI5B,KAAK,CAACmC,OAAO,KAAK,CAAC,CAAC,EAAE;QAC/BP,QAAQ,GAAGG,KAAK,CAACM,GAAG,CAAC,CAAC;MACxB,CAAC,MAAM,IAAIrC,KAAK,CAACmC,OAAO,KAAK,CAAC,EAAE;QAC9BP,QAAQ,CAACQ,IAAI,CAACF,OAAO,CAAC;MACxB;IACF;EACF;EAEA,OAAON,QAAQ;AACjB"}